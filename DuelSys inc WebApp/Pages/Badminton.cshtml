@page
@using System.Security.Claims
@using System.Diagnostics.Eventing.Reader
@model DuelSys_inc_WebApp.Pages.BadmintonModel
@{
}
<script>
	const submitTournament = (tournamentId) => {
		const input = document.getElementById("tournament-input")
		const form = document.getElementById("tournament-form")
		input.value = tournamentId
		console.log(tournamentId)
		form.submit()
	}
</script>
<header id="header">
	<h1><a href="">DuelSys Inc.</a> sport tournaments</h1>
	<nav id="nav">
		<ul>
			<li><a href="Index">Home</a></li>
			<li><a href="Login" class="button">Login</a></li>
		</ul>
	</nav>
</header>
<div id="page-wapper">
	<div class="container">
		<h2>Tournaments List</h2>

		<form method="post" id="tournament-form">
			<input asp-for="TournamentId" id="tournament-input" type="hidden" />

			<ul>
				@foreach (var t in Model.TournamentService.GetAllBadmintonTournamentsForView())
				{
					<li class="no-bullet-list">
						<div class="tournament-register-card">
							<div class="card-header">
								<img src="img/pngfind.com-shuttlecock-png-5759382.png" style="width: 75px">
								<div>
									<span>@t.Description</span><br>
									<span>@t.Location</span>
								</div>
								<div class="animated-progress progress-green">
									<span data-progress="@Model.TournamentService.GetTournamentOccupancyPercentage(t.Id)"></span>
								</div>
							</div>
							@{
								if (Model.Validation.ValidTournamentRegistration(int.Parse(HttpContext.User.FindFirstValue(ClaimTypes.NameIdentifier)), t.Id))
								{
									<button class="button tournament-register" onclick="submitTournament(@t.Id)">Register</button>
								}
								else
								{
									<h4 class="tournament-register">You are Registered</h4>
								}
							}
						</div>
					</li>
				}
			</ul>
		</form>
	</div>
</div>
